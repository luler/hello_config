(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[9],{mJQH:function(e,t,a){"use strict";a.r(t);a("T2oS");var n,o,i=a("W9HT"),r=(a("g9YV"),a("wCAj")),c=(a("14J3"),a("BMrR")),l=(a("jCWc"),a("kPKH")),s=(a("y8nQ"),a("Vl3Y")),p=(a("5NDa"),a("5rEg")),d=(a("+L6B"),a("2/Rp")),u=(a("sPJy"),a("bE4q")),m=(a("/zsF"),a("PArb")),h=(a("miYZ"),a("tsqr")),f=a("p0pE"),v=a.n(f),_=a("2Taf"),k=a.n(_),w=a("vZ4D"),E=a.n(w),b=a("rlhR"),g=a.n(b),y=a("MhPg"),j=a.n(y),x=a("l4Ni"),C=a.n(x),S=a("ujKo"),I=a.n(S),L=(a("2qtc"),a("kLXV")),P=a("q1tI"),R=a.n(P),W=a("MuoO"),K=a("KHju"),T=a("6YkS");function O(e){var t=q();return function(){var a,n=I()(e);if(t){var o=I()(this).constructor;a=Reflect.construct(n,arguments,o)}else a=n.apply(this,arguments);return C()(this,a)}}function q(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var B=L["a"].confirm,J=(n=Object(W["connect"])(function(e){var t=e.api,a=e.loading;return{api:t,_loading:a.effects["api/getProjectEnvWebhookList"]}}),n(o=function(e){j()(a,e);var t=O(a);function a(){var e;k()(this,a);for(var n=arguments.length,o=new Array(n),i=0;i<n;i++)o[i]=arguments[i];return e=t.call.apply(t,[this].concat(o)),e.state={params:{project_env_id:0},selectedRowKeys:[],visible:!1,temp_data:{},model_title:"",webhooking:!1},e.showConfirm=function(t){var a=g()(e);B({title:"\u4f60\u786e\u5b9a\u8981\u5220\u9664\u9009\u4e2d\u9879\u5417?",content:"\u6ce8\u610f\uff1a\u70b9\u51fb\u786e\u8ba4\uff0c\u5c06\u5220\u9664\u65e0\u6cd5\u6062\u590d",okText:"\u786e\u5b9a",cancelText:"\u53d6\u6d88",onOk:function(){Object(K["a"])("/api/delProjectEnvWebhook",{ids:t}).then(function(e){200===e.code&&a.fetch()})}})},e.onSelectChange=function(t){e.setState({selectedRowKeys:t})},e}return E()(a,[{key:"componentDidMount",value:function(){var e=this;this.setState({params:v()({},this.state.params,{project_env_id:this.props.match.params.project_env_id})},function(){e.fetch()}),h["a"].config({top:100,duration:2,maxCount:3})}},{key:"fetch",value:function(){var e=this.props.dispatch;e({type:"api/getProjectEnvWebhookList",payload:this.state.params})}},{key:"render",value:function(){var e,t,a=this,n=[{title:"Id",dataIndex:"id",key:"id",width:64},{title:"\u56de\u8c03\u5730\u5740",dataIndex:"web_url",key:"web_url",width:300},{title:"\u6700\u8fd1\u6267\u884c\u65f6\u95f4",dataIndex:"last_execute_time",key:"last_execute_time",width:240},{title:"\u6700\u8fd1\u6267\u884c\u8fd4\u56de",dataIndex:"last_return",key:"last_return",width:320},{title:"\u5907\u6ce8",dataIndex:"desc",key:"desc",width:240},{title:"\u9879\u76ee\u540d\u79f0/\u73af\u5883\u7801",key:"project_en_name",width:160,render:function(e,t){return R.a.createElement("div",null,"".concat(t.project_name,"/").concat(t.env_code))}},{title:"\u64cd\u4f5c",key:"action",width:160,render:function(e,t){return R.a.createElement("span",null,R.a.createElement("a",{onClick:function(){var e=a.props.dispatch;a.setState({webhooking:!0}),e({type:"api/executeProjectEnvWebhook",payload:{id:t.id}}).then(function(){a.setState({webhooking:!1}),a.fetch()})}},"\u6267\u884c"),R.a.createElement(m["a"],{type:"vertical"}),R.a.createElement("a",{onClick:function(){a.setState({visible:!0,model_title:"\u7f16\u8f91\u56de\u8c03\u5730\u5740",temp_data:{id:t.id,web_url:t.web_url,desc:t.desc}})}},"\u7f16\u8f91"),R.a.createElement(m["a"],{type:"vertical"}),R.a.createElement("a",{onClick:function(){a.showConfirm([t.id])}},"\u5220\u9664"))}}],o=this.props,f=o._loading,_=o.api,k=this.state.selectedRowKeys;return R.a.createElement(i["a"],{tip:"\u6b63\u5728\u6267\u884cwebhook (\u6ce8\uff1a\u5982\u679c\u957f\u65f6\u95f4\u672a\u5173\u95ed\uff0c\u8bf7\u5237\u65b0\u9875\u9762\uff01)",size:"large",spinning:this.state.webhooking},R.a.createElement("div",null,R.a.createElement(u["a"],null,R.a.createElement(u["a"].Item,null,R.a.createElement(T["Link"],{to:"/"},"\u9996\u9875")),R.a.createElement(u["a"].Item,null,R.a.createElement(T["Link"],{to:{pathname:"/project/index",state:this.props.location.state}},"\u9879\u76ee\u5217\u8868",(null===(e=this.props.location.state)||void 0===e?void 0:e.title)?"\uff08"+this.props.location.state.title+"\uff09":"")),R.a.createElement(u["a"].Item,null,R.a.createElement(T["Link"],{to:{pathname:"/project/"+(null===(t=this.props.location.state)||void 0===t?void 0:t.project_id)+"/env",state:this.props.location.state}},"\u9879\u76ee\u73af\u5883")),R.a.createElement(u["a"].Item,null,"webhook")),R.a.createElement("div",{style:{backgroundColor:"white",padding:"10px 20px",marginTop:20}},R.a.createElement("div",{style:{padding:"20px 0"}},R.a.createElement(c["a"],null,R.a.createElement(l["a"],{span:8},R.a.createElement(d["a"],{type:"primary",onClick:function(){a.setState({visible:!0,model_title:"\u65b0\u589e\u56de\u8c03\u5730\u5740",temp_data:{}})}},"\u65b0\u589e"),R.a.createElement(L["a"],{title:this.state.model_title,visible:this.state.visible,confirmLoading:this.state.confirmLoading||!1,okText:"\u4fdd\u5b58",onOk:function(){var e=a.state.temp_data,t="/api/addProjectEnvWebhook";e.id&&(t="/api/editProjectEnvWebhook"),e.project_env_id=a.state.params.project_env_id,a.setState({confirmLoading:!0}),Object(K["a"])(t,e).then(function(e){a.setState({confirmLoading:!1}),200===e.code&&a.setState({visible:!1},function(){a.fetch()})})},onCancel:function(){a.setState({visible:!1,confirmLoading:!1})}},R.a.createElement(s["a"],{labelCol:{xs:{span:24},sm:{span:4}},wrapperCol:{xs:{span:24},sm:{span:20}}},R.a.createElement(s["a"].Item,{required:!0,label:"\u56de\u8c03\u5730\u5740"},R.a.createElement(p["a"],{onInput:function(e){a.setState({temp_data:v()({},a.state.temp_data,{web_url:e.target.value})})},name:"web_url",placeholder:"\u8bf7\u8f93\u5165\u56de\u8c03\u5730\u5740",value:this.state.temp_data.web_url||""})),R.a.createElement(s["a"].Item,{label:"\u5907\u6ce8"},R.a.createElement(p["a"].TextArea,{rows:5,onInput:function(e){a.setState({temp_data:v()({},a.state.temp_data,{desc:e.target.value})})},name:"desc",placeholder:"\u8bf7\u8f93\u5165\u5907\u6ce8",value:this.state.temp_data.desc||""})))),"\xa0\xa0\xa0\xa0",R.a.createElement(d["a"],{type:"danger",onClick:function(e){0===k.length?h["a"].warning("\u8bf7\u9009\u62e9\u9700\u8981\u5220\u9664\u7684\u9879"):a.showConfirm(k),e.stopPropagation()}},"\u5220\u9664\u9009\u4e2d")))),R.a.createElement(r["a"],{scroll:{x:!0},style:{marginBottom:20},dataSource:_.putProjectEnvWebhookList,rowKey:function(e){return e.id},pagination:!1,columns:n,loading:f,rowSelection:{selectedRowKeys:k,onChange:this.onSelectChange}}))))}}]),a}(P["Component"]))||o);t["default"]=J}}]);